{
  "tabla": "documentos_clientes",
  "descripcion": "Tabla para almacenar documentos de clientes (INE, RFC, comprobantes, etc.)",
  "estructura": {
    "campos": {
      "id": {
        "tipo": "INT",
        "auto_increment": true,
        "primary_key": true,
        "null": false,
        "descripcion": "ID único del documento"
      },
      "cliente_id": {
        "tipo": "INT",
        "null": false,
        "foreign_key": "clientes.id",
        "descripcion": "ID del cliente al que pertenece el documento",
        "on_delete": "CASCADE",
        "on_update": "CASCADE"
      },
      "tipo": {
        "tipo": "VARCHAR(100)",
        "null": false,
        "descripcion": "Tipo de documento",
        "ejemplos": [
          "Identificación Oficial (INE/Pasaporte)",
          "Comprobante de Domicilio",
          "RFC",
          "CURP",
          "Acta Constitutiva",
          "Poder Notarial"
        ]
      },
      "nombre": {
        "tipo": "VARCHAR(255)",
        "null": false,
        "descripcion": "Nombre del archivo",
        "ejemplo": "INE_Juan_Perez_2025-10-20.pdf"
      },
      "ruta_archivo": {
        "tipo": "VARCHAR(500)",
        "null": false,
        "descripcion": "Ruta completa donde se guardó el archivo en el servidor",
        "ejemplo": "/uploads/clientes/1/documentos/INE_Juan_Perez_2025-10-20.pdf"
      },
      "extension": {
        "tipo": "VARCHAR(10)",
        "null": true,
        "descripcion": "Extensión del archivo",
        "ejemplos": ["pdf", "jpg", "png", "doc", "docx"]
      },
      "fecha_subida": {
        "tipo": "DATE",
        "null": false,
        "descripcion": "Fecha en que se subió el documento",
        "ejemplo": "2025-10-20"
      },
      "estado": {
        "tipo": "ENUM('Vigente', 'Vencido', 'Por renovar')",
        "null": false,
        "default": "Vigente",
        "descripcion": "Estado actual del documento"
      },
      "tipo_archivo": {
        "tipo": "VARCHAR(50)",
        "null": true,
        "descripcion": "MIME type del archivo",
        "ejemplos": ["application/pdf", "image/jpeg", "image/png"]
      },
      "tamaño": {
        "tipo": "VARCHAR(20)",
        "null": true,
        "descripcion": "Tamaño del archivo",
        "ejemplo": "2.5 MB"
      },
      "notas": {
        "tipo": "TEXT",
        "null": true,
        "descripcion": "Notas adicionales sobre el documento"
      },
      "created_at": {
        "tipo": "TIMESTAMP",
        "null": false,
        "default": "CURRENT_TIMESTAMP",
        "descripcion": "Fecha de creación del registro"
      },
      "updated_at": {
        "tipo": "TIMESTAMP",
        "null": false,
        "default": "CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
        "descripcion": "Fecha de última actualización"
      }
    },
    "indices": [
      {
        "nombre": "idx_cliente_id",
        "campos": ["cliente_id"],
        "tipo": "INDEX",
        "proposito": "Optimizar búsquedas por cliente"
      },
      {
        "nombre": "idx_tipo",
        "campos": ["tipo"],
        "tipo": "INDEX",
        "proposito": "Búsquedas por tipo de documento"
      },
      {
        "nombre": "idx_estado",
        "campos": ["estado"],
        "tipo": "INDEX",
        "proposito": "Filtrar por estado (vigente, vencido, etc.)"
      },
      {
        "nombre": "idx_fecha_subida",
        "campos": ["fecha_subida"],
        "tipo": "INDEX",
        "proposito": "Ordenar por fecha"
      }
    ],
    "foreign_keys": [
      {
        "nombre": "fk_documentos_cliente",
        "campo_local": "cliente_id",
        "tabla_referencia": "clientes",
        "campo_referencia": "id",
        "on_delete": "CASCADE",
        "on_update": "CASCADE",
        "descripcion": "Si se elimina un cliente, se eliminan todos sus documentos"
      }
    ]
  },
  "api_endpoints": {
    "listar_documentos_cliente": {
      "method": "GET",
      "path": "/api/clientes/:cliente_id/documentos",
      "descripcion": "Obtener todos los documentos de un cliente",
      "response_success": {
        "status": 200,
        "body": {
          "success": true,
          "data": [
            {
              "id": 1,
              "cliente_id": 1,
              "tipo": "Identificación Oficial (INE/Pasaporte)",
              "nombre": "INE_Juan_Perez_2025-10-20.pdf",
              "ruta_archivo": "/uploads/clientes/1/documentos/INE_Juan_Perez_2025-10-20.pdf",
              "extension": "pdf",
              "fecha_subida": "2025-10-20",
              "estado": "Vigente",
              "tipo_archivo": "application/pdf",
              "tamaño": "2.5 MB",
              "url_descarga": "https://api.example.com/descargar/documento/1",
              "created_at": "2025-10-20T10:30:00Z"
            }
          ]
        }
      }
    },
    "subir_documento": {
      "method": "POST",
      "path": "/api/clientes/:cliente_id/documentos",
      "descripcion": "Subir un nuevo documento para un cliente",
      "content_type": "multipart/form-data",
      "request_body": {
        "tipo": "Identificación Oficial (INE/Pasaporte)",
        "archivo": "file (binary)",
        "estado": "Vigente",
        "notas": "Documento actualizado"
      },
      "validaciones": {
        "archivo": {
          "extensiones_permitidas": ["pdf", "jpg", "jpeg", "png", "doc", "docx"],
          "tamaño_maximo": "10 MB",
          "requerido": true
        },
        "tipo": {
          "requerido": true,
          "debe_existir_en_catalogo": true
        }
      },
      "response_success": {
        "status": 201,
        "body": {
          "success": true,
          "message": "Documento subido exitosamente",
          "data": {
            "id": 1,
            "cliente_id": 1,
            "tipo": "Identificación Oficial (INE/Pasaporte)",
            "nombre": "INE_Juan_Perez_2025-10-20.pdf",
            "ruta_archivo": "/uploads/clientes/1/documentos/INE_Juan_Perez_2025-10-20.pdf",
            "fecha_subida": "2025-10-20",
            "estado": "Vigente",
            "tamaño": "2.5 MB"
          }
        }
      }
    },
    "actualizar_documento": {
      "method": "PUT",
      "path": "/api/clientes/:cliente_id/documentos/:documento_id",
      "descripcion": "Actualizar información de un documento (sin cambiar el archivo)",
      "request_body": {
        "estado": "Vencido",
        "notas": "Documento por renovar"
      },
      "response_success": {
        "status": 200,
        "body": {
          "success": true,
          "message": "Documento actualizado exitosamente"
        }
      }
    },
    "reemplazar_documento": {
      "method": "POST",
      "path": "/api/clientes/:cliente_id/documentos/:documento_id/reemplazar",
      "descripcion": "Reemplazar el archivo de un documento existente",
      "content_type": "multipart/form-data",
      "request_body": {
        "archivo": "file (binary)"
      },
      "response_success": {
        "status": 200,
        "body": {
          "success": true,
          "message": "Documento reemplazado exitosamente"
        }
      }
    },
    "eliminar_documento": {
      "method": "DELETE",
      "path": "/api/clientes/:cliente_id/documentos/:documento_id",
      "descripcion": "Eliminar un documento (archivo y registro)",
      "response_success": {
        "status": 200,
        "body": {
          "success": true,
          "message": "Documento eliminado exitosamente"
        }
      }
    },
    "descargar_documento": {
      "method": "GET",
      "path": "/api/clientes/:cliente_id/documentos/:documento_id/descargar",
      "descripcion": "Descargar el archivo del documento",
      "response_success": {
        "status": 200,
        "content_type": "application/pdf (o el tipo correspondiente)",
        "headers": {
          "Content-Disposition": "attachment; filename=\"nombre_archivo.pdf\""
        }
      }
    },
    "ver_documento": {
      "method": "GET",
      "path": "/api/clientes/:cliente_id/documentos/:documento_id/ver",
      "descripcion": "Ver el documento en el navegador (sin descargar)",
      "response_success": {
        "status": 200,
        "content_type": "application/pdf (o el tipo correspondiente)",
        "headers": {
          "Content-Disposition": "inline; filename=\"nombre_archivo.pdf\""
        }
      }
    }
  },
  "configuracion_backend": {
    "almacenamiento_archivos": {
      "ubicacion": "/uploads/clientes/{cliente_id}/documentos/",
      "estructura_carpetas": "Por ID de cliente",
      "ejemplo": "/uploads/clientes/1/documentos/INE_Juan_Perez_2025-10-20.pdf"
    },
    "nombrado_archivos": {
      "patron": "{tipo_documento}_{nombre_cliente}_{fecha}_{random}.{extension}",
      "ejemplo": "INE_Juan_Perez_2025-10-20_a3f5d9.pdf",
      "sanitizar": "Remover caracteres especiales y espacios"
    },
    "validaciones": {
      "extensiones_permitidas": ["pdf", "jpg", "jpeg", "png", "doc", "docx"],
      "tamaño_maximo_mb": 10,
      "verificar_mime_type": true,
      "escaneo_virus": "Recomendado"
    },
    "seguridad": {
      "autenticacion": "Requerida (Bearer token)",
      "autorizacion": "Solo el dueño del cliente puede ver/editar documentos",
      "ruta_publica": false,
      "proteccion_url": "Token temporal o firma para descargas"
    }
  },
  "ejemplo_uso_frontend": {
    "subir_documento": {
      "descripcion": "Ejemplo de cómo subir un documento desde React",
      "codigo": "const formData = new FormData(); formData.append('archivo', file); formData.append('tipo', tipoDocumento); formData.append('estado', 'Vigente'); const response = await fetch(`${API_URL}/api/clientes/${clienteId}/documentos`, { method: 'POST', headers: { 'Authorization': `Bearer ${token}` }, body: formData });"
    }
  }
}
